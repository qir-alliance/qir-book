# QAT
QAT stands for Quantum Adaptor Tool and is designed to convert a generic QIR into a specific backend-targeted QIR, ensuring compliance with the requirements of the certain profile. As mentioned in the previous section, QIR target represents a subset of the generic QIR. In practice, most implementations of the QIR specification for a target machine will only utilize a subset of its features. These subsets may have additional constraints, such as the dynamic allocation or/and handling qubits. Such a constrained subset is referred to as a "target"[23]. For example, early versions of quantum backends may have limited classical instructions available. In this case, the vendor or user of the backend would define a profile that includes only a specified subset of capabilities. A target includes of a classical profile and a Quantum Instruction Set (QIS).
QAT’s architecture consists of three main tasks: loading the QIR, creating a generator and validator, and transforming and validating the QIR [23]. The profile requires a generator and a validator. The generator performs transformations on the generic QIR to make it compliant with the selected profile, using a configuration with LLVM passes. The validator checks the compliance of a specialized QIR with the profile. The process involves passing the QIR through various components, which can install and execute different LLVM passes based on the configuration. QAT aims to preserve the modularity and extendibility of LLVM's opt tool while, adding the required capabilities for profile transformations and validation. The transformation component is highly configurable and performs replacements in the IR using a custom replacer function [23].

The generic QIR supports dynamic qubit allocation as the default method for allocating qubits. However, there is a fundamental difference in how simulators and hardware backends handle qubit allocation. Simulators can dynamically allocate qubits as needed, while hardware backends have a limited number of qubits and lack the necessary logic for dynamic management. As a result, it becomes necessary to convert dynamic qubit management into static allocation to ensure compatibility with backends such as simulators.

QAT is command line tool that allows for LLVM passes and lowering the code according to a profile.  The target configurations can be defined entirely using the command line; however it is recommended to be formatted in a .yaml file.  The configuration has three sections. First, there is a high-level description of the adaptor pipeline, whether the target needs adaption or validation. Second, the adaptor for each component is indicated. Thirdly, validation of final QAT result against certain target.  Validating the QIR tasks are checking that the QIR is compliant with the profile specification and that the QIR only uses the specified QIS [23].

Adaptors offer various transformation of the IR according to specific requirements. The adaptor configuration settings include flags for applying adaptors, validating and emitting human readable LLVM IR. Validation of the QIR involves two tasks: target profile validation and target QIS validation. The target profile validation verifies compliance with classical behavior, such as allowing internal calls, poison values, undefined values, opcodes, external calls, and pointer types. The target QIS validation checks if qubits and results are required in the IR and specifies the allowed QIS signatures [23].

The adaptors in QAT serve different purposes in the transformation process such as the option of optimization of the IR using various LLVM passes. QAT’s target mapping in the adaptor transforms the QIR to a targeted version based on the quantum instruction set, including mapping dynamic qubit and result to static allocation. The target profile mapping adaptor performs additional optimizations after the final generic transformation. The replacement linking adaptor conditionally replaces function calls based on the presence of replacement functions in the QIR [23].

2.5.1.	Replacement Linking
Replacement linking is a process where one function call in IR is replaced by another. For example, if the function is generating sequences of H, X and H, it can be replaced by a function with only Z gate [24]. This provides a mechanism to address hardware compatibility issues as well general circuit decomposition optimizations. It enables the use of software implementations for unsupported gates and ensures that code written at the frontend level can be executed on targets with different native gate set, without the need for extensive modifications. Moreover, it allows for reducing the size of the circuit which leads to efficient compilation and runtime. This report in intended to use replacement linking as a tool for quantum circuit decomposition optimization pass.
