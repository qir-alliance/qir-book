# MLIR for QIR
MLIR stands for Multi-Level Intermediate Representation. It is an open-source project developed within [LLVM]( https://llvm.org/) that provides an infrastructure for building and optimizing compilers. The goal of MLIR is to enable the development of a wide range of compiler tools that can operate on programs at various levels of IR abstraction. It is designed to enable the representation of a wide range of tools for high-level constructs like loops and functions down to low-level constructs like instruction generation.

The motivation for developing MLIR arose from the observation that modern machine learning frameworks were constructed using different compilers, graph technologies, and runtime systems without a common infrastructure. This resulted in duplicated abstraction layers, tools and difficulties in generalizing the layers to support new hardware. There was a need for sharing frontend lowering infrastructure with common design principles. The MLIR project aimed to provide a mutual compilers infrastructure, allowing for analysis and optimization of computations as graphs. It uses the [SSA](qir-book/concepts/WhyLLVM.md) form in the IR with the advantages of making dataflow analysis simple and with more efficient algorithms.

MLIR allows developers to write code in multiple levels of abstraction through the use of dialects. Each dialect defines its own set of high-level abstractions and optimizations that are specific to that domain. To optimize code, MLIR provides a set of generic optimization passes that can be applied to any dialect. These passes operate at a higher level of abstraction and are not specific to any particular dialect. For example, a common optimization pass is loop optimization, which looks for loops in the code and applies optimizations to make them faster. In contrast, dialect-specific optimization passes operate at a lower level of abstraction and are specific to the dialect they are designed for. They are tailored to the specific abstractions and semantics of a given dialect, and thus can provide specific optimizations. The ability to represent multiple levels of abstraction for one IR incentivizes passes that operate across these levels.

For QIR, MLIR provides a modular framework that can be customized to target different hardware platforms. This allows QIR to be compiled to a wide range of quantum target machines, without having to write device-specific code. MLIR backed optimizations in QIR operate at multiple levels of abstraction, including dialect-specific optimizations, which can be tailored to the needs of hybrid computations.
